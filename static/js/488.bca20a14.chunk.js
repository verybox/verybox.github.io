"use strict";(self.webpackChunkverybox_tools=self.webpackChunkverybox_tools||[]).push([[488],{53488:function(e,t,a){a.r(t),a.d(t,{default:function(){return G}});var n=a(47313),s=a(24240),r=a(82937),i=a(36368),l=a(73477),d=a(11626),c=a(62463),o=a(83077),m=a(43394),u=a(66356),h=a(68737),x=a(17201),p=a(35540),g=a(25319),P=a(10383),j=a(91294),Z=a(74897),v=a(81962),y=a(35192),f=a(62111),b=a(46417);function F(e){const{t:t}=(0,s.$)(),[a,d]=((0,f.Z)(),(0,n.useState)(""));return n.useEffect((()=>{d(e.value)}),[e]),(0,b.jsxs)(r.ZP,{container:!0,spacing:1,children:[(0,b.jsx)(r.ZP,{item:!0,xs:3,children:(0,b.jsxs)(P.Z,{fullWidth:!0,children:[(0,b.jsx)(j.Z,{id:"param_label"+e.index,size:"small",children:t("mintNFT.paramType")}),(0,b.jsxs)(Z.Z,{id:"param_select_"+e.index,name:"S_"+e.index,label:t("mintNFT.paramType"),labelId:"param_label"+e.index,size:"small",value:e.type,onChange:t=>{e.paramSelectChange(t)},children:[(0,b.jsx)(v.Z,{value:"address",children:"address"}),(0,b.jsx)(v.Z,{value:"uint8",children:"uint8"}),(0,b.jsx)(v.Z,{value:"uint256",children:"uint256"}),(0,b.jsx)(v.Z,{value:"bool",children:"bool"}),(0,b.jsx)(v.Z,{value:"string",children:"string"}),(0,b.jsx)(v.Z,{value:"merkleSign",children:"merkleSign"})]})]})}),(0,b.jsx)(r.ZP,{item:!0,xs:6,children:(0,b.jsx)(i.Z,{fullWidth:!0,id:"T_"+e.index,label:t("mintNFT.paramValue"),variant:"outlined",size:"small",value:a,onChange:t=>{e.paramChange(t)}})}),(0,b.jsx)(r.ZP,{item:!0,xs:1,children:(0,b.jsx)(l.Z,{id:e.index,variant:"outlined",startIcon:(0,b.jsx)(y.Z,{}),onClick:e.deleteParam,children:t("mintNFT.delParam")})})]})}var T=a(25091),A=a(71247),w=a(33497),C=a(32703),k=a(12274),N=a(83838);a(78466);const S=a(15372);let I=!1;var G=function(){const{t:e}=(0,s.$)(),t=(0,f.Z)(),{CHAIN:a,CHAINID:P}=T.IB,[j,Z]=(0,n.useState)(T.IB.RPC),[v,y]=(0,n.useState)(new S(new S.providers.HttpProvider(j))),[G,_]=(0,n.useState)("mint"),[V,z]=(0,n.useState)([{type:"uint256",value:1}]),[O,K]=(0,n.useState)(!1),[M,W]=(0,n.useState)({type:"",msg:null}),[D,L]=(0,n.useState)(!1),[H,E]=(0,n.useState)({addrStr:"",pkStr:"",pkArr:[],addrArr:[]}),[R,q]=(0,n.useState)({isOpen:!1,msg:"",nonce:""}),[B,U]=(0,n.useState)({contractAddress:"",maxPriorityFeePerGas:1,maxFeePerGas:10,ethValue:0}),$=e=>{J(e.target.id,e.target.value)},J=(e,t)=>{const a={[e]:t};U((e=>({...e,...a})))},Q=e=>{let t=e.target.name.slice(2),a=e.target.value;V[t].type=a,z(V),se()},X=e=>{let t=e.target.id.slice(2),a=e.target.value;V[t].value=a,z(V),se()},Y=()=>{let e=setInterval((async()=>{const t=await async function(e){const{_estimateGas:t}=(0,A.n)(v,a),n=v.eth.accounts.privateKeyToAccount(e).address,s=await te(n).then((e=>e));let r=await v.eth.getTransactionCount(n);return await t({from:n,to:B.contractAddress,value:B.ethValue||0,gasLimit:T.Lw,maxPriorityFeePerGas:B.maxPriorityFeePerGas,maxFeePerGas:B.maxFeePerGas,data:s,nonce:r})}(H.pkArr[0]);if(t.error)return clearInterval(e),void q({isOpen:!0,msg:t.error,nonce:parseInt(1e4*Math.random())});"number"==typeof t&&t<T.Lw&&(clearInterval(e),H.pkArr.forEach(((e,t)=>{!async function(e,t){const{_sendTx:n}=(0,A.n)(v,a),s=v.eth.accounts.privateKeyToAccount(e).address,r=await te(s).then((e=>e));let i=await v.eth.getTransactionCount(s);const l=await n({from:s,to:B.contractAddress,value:B.ethValue||0,gasLimit:T.Lw,maxPriorityFeePerGas:B.maxPriorityFeePerGas,maxFeePerGas:B.maxFeePerGas,data:r,nonce:i,pk:e});let d="";d=Object.keys(l).includes("error")?"\xd7 "+l.error:"\u2713 "+l.transactionHash;ee({index:t,timesChange:0,status:d})}(e,t),ee({index:t,timesChange:1,status:"pending..."}),H.pkArr.length-1==t&&L(!1)})))}),1e3)},ee=async e=>{let{index:t,timesChange:a,status:n}=e;try{le((e=>{let s=[...e];for(let r=0;r<s.length;r++)r==t&&(s[r]={id:s[r].id,address:s[r].address,balance:s[r].balance,times:s[r].times+a,status:n});return s}))}catch(s){}q({isOpen:!0,msg:n,nonce:parseInt(1e4*Math.random())})};async function te(e){let t="",a=[],n=[];for(let s=0;s<V.length;s++){const r=V[s];let i,l;if("merkleSign"==r.type){if(i=await(0,k.t)(B.contractAddress.toLowerCase(),e),!i.sign)return void q({isOpen:!0,msg:"Unable to get merkleSign",nonce:parseInt(1e4*Math.random())});l=i.sign}const d="merkleSign"==r.type?"bytes32[]":r.type,c="merkleSign"==r.type?l:r.value;t=""==t?t+d:t+","+d,a.push(d),n.push(c)}return v.eth.abi.encodeFunctionSignature(G+"("+t+")")+v.eth.abi.encodeParameters(a,n).slice(2)}const[ae,ne]=(0,n.useState)([]),se=()=>{let e=[];V.forEach(((t,a)=>{e.push((0,b.jsx)(r.ZP,{item:!0,xs:12,children:(0,b.jsx)(F,{index:a,type:V[a].type,value:V[a].value,paramSelectChange:Q,paramChange:X,deleteParam:re})},a))})),ne(e)},re=e=>{V.splice(e.target.id,1),z(V),se()};(0,n.useEffect)((()=>{se()}),[]);const[ie,le]=(0,n.useState)([{id:1,address:"",balance:"",times:"",status:"",action:""}]),de=[{field:"id",hide:!0},{field:"address",headerName:e("mintNFT.address"),width:150},{field:"balance",headerName:e("mintNFT.amount"),width:80},{field:"times",headerName:e("mintNFT.requestTimes"),width:160},{field:"status",headerName:e("mintNFT.status"),width:400}],ce=async e=>{let t=await Promise.all(e.map((async(e,t)=>{const a=v.eth.accounts.privateKeyToAccount(e).address,n=await v.eth.getBalance(a);return{id:t+1,address:a,balance:v.utils.fromWei(n,"ether"),times:0,status:"--"}})));le(t)},[oe,me]=(0,n.useState)(new Date),[ue,he]=(0,n.useState)(!1),[xe,pe]=(0,n.useState)(0),[ge,Pe]=(0,n.useState)({}),je=(e,t)=>{Pe((a=>({...a,[e]:t})))},Ze=()=>{const e=ve(B.contractAddress);if(je("contractAddress",!e),!e)return q({isOpen:!0,msg:"Contract Address required",nonce:parseInt(1e4*Math.random())}),!1;const t=(a=B.ethValue,"NaN"!=parseFloat(a).toString());var a;if(je("ethValue",!t),!t)return q({isOpen:!0,msg:"Eth Value not valid",nonce:parseInt(1e4*Math.random())}),!1;const n=ye();return je("privateKey",!n),!!n||(q({isOpen:!0,msg:"Private Key required",nonce:parseInt(1e4*Math.random())}),!1)},ve=e=>""!=e&&v.utils.isAddress(e),ye=()=>H.pkArr.length>0;return(0,b.jsx)(w.Z,{title:e("mintNFT.title"),children:(0,b.jsxs)(r.ZP,{container:!0,spacing:2,children:[(0,b.jsx)(r.ZP,{item:!0,xs:12,children:(0,b.jsx)(r.ZP,{container:!0,spacing:2,children:(0,b.jsx)(r.ZP,{item:!0,xs:12,children:(0,b.jsx)(p.Z,{action:{changeRPCAction:e=>{e.available&&y(new S(new S.providers.HttpProvider(e.rpc)))}},data:{rpc:j}})})})}),(0,b.jsx)(r.ZP,{item:!0,xs:12,children:(0,b.jsxs)(r.ZP,{container:!0,spacing:2,children:[(0,b.jsx)(r.ZP,{item:!0,xs:9,sm:6,children:(0,b.jsx)(i.Z,{error:ge.contractAddress,fullWidth:!0,id:"contractAddress",label:e("mintNFT.contractAddress"),variant:"outlined",size:"small",value:B.contractAddress,onChange:$})}),(0,b.jsx)(r.ZP,{item:!0,xs:1,children:(0,b.jsx)(l.Z,{variant:"text",onClick:()=>{J("contractAddress","")},children:e("mintNFT.contractAddressClear")})})]})}),(0,b.jsx)(r.ZP,{item:!0,xs:12,children:(0,b.jsxs)(r.ZP,{container:!0,spacing:2,children:[(0,b.jsx)(r.ZP,{item:!0,xs:12,sm:3,children:(0,b.jsx)(i.Z,{fullWidth:!0,id:"maxPriorityFeePerGas",label:e("mintNFT.maxpriorityfeepergas"),variant:"outlined",size:"small",type:"number",value:B.maxPriorityFeePerGas,onChange:$})}),(0,b.jsx)(r.ZP,{item:!0,xs:12,sm:3,children:(0,b.jsx)(i.Z,{fullWidth:!0,id:"maxFeePerGas",label:e("mintNFT.maxFeePerGas"),variant:"outlined",size:"small",type:"number",value:B.maxFeePerGas,onChange:$})}),(0,b.jsx)(r.ZP,{item:!0,xs:12,sm:3,children:(0,b.jsx)(i.Z,{error:ge.ethValue,fullWidth:!0,id:"ethValue",label:e("mintNFT.ethAmout"),variant:"outlined",size:"small",type:"number",value:B.ethValue,onChange:$})})]})}),(0,b.jsx)(r.ZP,{item:!0,xs:12,children:(0,b.jsx)(r.ZP,{container:!0,spacing:2,children:(0,b.jsx)(r.ZP,{item:!0,xs:12,sm:3,children:(0,b.jsx)(i.Z,{id:"mint_method",label:e("mintNFT.mintMethod"),variant:"outlined",size:"small",value:G,onChange:e=>{_(e.target.value)}})})})}),(0,b.jsx)(r.ZP,{item:!0,xs:12,children:(0,b.jsx)(r.ZP,{container:!0,spacing:2,children:(0,b.jsxs)(r.ZP,{item:!0,xs:12,children:[e("mintNFT.method"),(0,b.jsx)(l.Z,{variant:"outlined",onClick:()=>{V.push({type:"",value:""}),z(V),se()},children:e("mintNFT.addParam")})]})})}),ae,(0,b.jsx)(r.ZP,{item:!0,xs:12,children:(0,b.jsx)(g.Z,{setPk:e=>{E(e),ce(e.pkArr)},provider:v,chain:a,title:e("mintNFT.importPrivateKeyTitle"),error:ge.privateKey,storageKey:"mintPk"})}),(0,b.jsx)(r.ZP,{item:!0,xs:12,style:{display:R.isOpen?" ":"none"},children:(0,b.jsx)(x.Z,{msg:R.msg,nonce:R.nonce})},R.msg),(0,b.jsx)(r.ZP,{item:!0,xs:12,children:(0,b.jsx)(r.ZP,{container:!0,spacing:2,children:(0,b.jsxs)(r.ZP,{item:!0,xs:12,children:[e("mintNFT.openTimer"),(0,b.jsx)(d.Z,{checked:ue,onChange:e=>{he(e.target.checked),I=e.target.checked}})]})})}),(0,b.jsx)(r.ZP,{item:!0,xs:12,sx:{fontsize:16,display:ue?"flex":"none",mt:1},children:(0,b.jsxs)(r.ZP,{container:!0,spacing:2,sx:{justifyContent:"flex-start",alignItems:"center",border:"solid 1px",borderColor:t.palette.grey[500],borderRadius:2,pb:"16px",ml:0,mr:0},children:[(0,b.jsxs)(r.ZP,{item:!0,sx:{minWidth:120,display:"flex"},children:[e("mintNFT.leftTime"),(0,b.jsx)("span",{style:{color:t.palette.secondary.main,paddingLeft:5},children:xe})]}),(0,b.jsx)(r.ZP,{item:!0,children:(0,b.jsx)(m._,{dateAdapter:o.H,children:(0,b.jsx)(c.Z,{spacing:3,children:(0,b.jsx)(u.x,{size:"small",hideTabs:!0,value:oe,onChange:e=>{me(e)},minDate:new Date("2022-05-1"),renderInput:e=>(0,b.jsx)(i.Z,{...e})})})})})]})}),(0,b.jsx)(r.ZP,{item:!0,xs:12,children:(0,b.jsx)(r.ZP,{container:!0,spacing:2,children:(0,b.jsx)(r.ZP,{item:!0,xs:12,children:(0,b.jsx)(C.Z,{onClick:async()=>{Ze()&&(()=>{const e={contractAddress:B.contractAddress,maxPriorityFeePerGas:B.maxPriorityFeePerGas,maxFeePerGas:B.maxFeePerGas,addressess:H.pkArr.map((e=>v.eth.accounts.privateKeyToAccount(e).address)),ethValue:B.ethValue,mintMethod:G};W({type:"_mintNFT",msg:e}),K(!0)})()},loading:D,variant:"contained",children:(0,b.jsx)("span",{children:e("mintNFT.execute")})})})})}),(0,b.jsx)(r.ZP,{item:!0,xs:12,style:{height:300,width:"100%"},children:(0,b.jsx)(h._,{rows:ie,columns:de})}),M.msg&&(0,b.jsx)(r.ZP,{item:!0,xs:12,children:(0,b.jsx)(N.U,{isOpen:O,msg:M.msg,okAction:async()=>{if(Ze())if(L(!0),I){let e=setInterval((()=>{let t=(new Date(oe).getTime()-Date.now())/1e3;t=t>0?t:0,pe(t),0!=I?0==t&&(clearInterval(e),Y()):clearInterval(e)}),100)}else Y()},closeDialog:()=>{K(!1)},type:M.type})})]})})}},12274:function(e,t,a){a.d(t,{t:function(){return r},g:function(){return n}});const n={"0x954055d4483cfde798631b19611ec8cba920bfb7":{name:"Test",twitter:"",url:"http://localhost:3001/sign",params:["address"],method:"get"}},s=a(31881).default,r=async(e,t)=>{if("0x954055d4483cfde798631b19611ec8cba920bfb7"===e){return await i(e,t)}},i=async(e,t)=>{const a=n[e].url;return await s.get(a,{params:{address:t}}).then((function(e){return{treeRoot:e.data.result.root?e.data.result.root:"",sign:e.data.result.s?e.data.result.s:[]}})).catch((function(e){return{treeRoot:"",sign:[]}}))}}}]);